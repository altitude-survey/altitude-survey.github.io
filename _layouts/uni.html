<!DOCTYPE html>

<html>
<head>
    <link rel="stylesheet" href="/css/uikit.min.css?{{site.time | date: '%s' }}" />
    <link rel="stylesheet" href="/css/add.css?{{site.time | date: '%s' }}" />
    <script src="/js/uikit.min.js"></script>
    <script src="/js/uikit-icons.min.js"></script>
    <script src="/js/textFit.min.js"></script>
    <meta charset="utf-8">
    <title>{{ page.title }}</title>
    {% seo title=false %}
</head>
<body>
    <!-- uni layout -->
    {% include menu.html %}   

    <main class="uk-container">
        {% if false %}
            <img src="/img/toplogo/{{ page.sortid }}.jpg" class="uk-align-left">
        {% endif %}
        <article class="uk-article">
                {% if page.cat == 0 %}
                    <h1 class="uk-article-title">{{ site.title }}</h1>
                {% else %}
                    <h1 class="uk-article-title">{{ page.title }}</h1>
                {% endif %}
                {{ content }}
        </article>
        {% if page.cat %}     
            <div class="uk-text-primary uk-text-middle uk-align-center uk-text-center">
                <span uk-icon="warning"></span> Для получения достоверной информации, необходимо профессионально обследовать ваш объект.                
                {% include el-contact-form.html %}
            </div>            
        {% endif %}
    </main>    
    {% include footer.html %}
    <div id="modal-contact-form" uk-modal>
        <div class="uk-modal-dialog uk-modal-body">
            <button class="uk-modal-close-default" type="button" uk-close></button>  
            <form class="uk-form-stacked" action="https://app.form2chat.io/f/95bac658.json" method="POST" accept-charset="UTF-8" id="contact-form">
        
            <div class="uk-margin">
                <label class="uk-form-label" for="form-name">Ваше имя</label>
                <div class="uk-form-controls">
                <input name="name" class="uk-input" id="form-name" type="text" placeholder="Ваше имя">
                </div>
            </div>
        
            <div class="uk-margin">
                <label class="uk-form-label" for="form-phone">Телефон</label>
                <div class="uk-form-controls">
                <input name="phone" class="uk-input" id="form-phone" type="tel" placeholder="Телефон" required>
                </div>
            </div>
        
            <div class="uk-margin">
                <label class="uk-form-label" for="form-email">Почта</label>
                <div class="uk-form-controls">
                <input name="email" class="uk-input" id="form-email" type="email" placeholder="Почта">
                </div>
            </div>
        
            <div class="uk-margin">
                <label class="uk-form-label" for="form-coment">Комментарии</label>
                <div class="uk-form-controls">
                <textarea name="coment" class="uk-textarea" id="form-coment" type="text" placeholder="Комментарии"></textarea>
                </div>
            </div>
        
            <div class="uk-margin uk-flex-center" uk-grid>
                <button type="submit" class="uk-button uk-button-default">Отправить</button>
            </div>
            <input type="hidden" name="_gotyou">
            </form>
        </div>
    </div>
    <script type="text/javascript">
        var form = document.getElementById("contact-form");
    
        form.onsubmit = function(e) {
        e.preventDefault();
    
        var formData = new FormData(form);
        var xhr = new XMLHttpRequest();
    
        xhr.open("POST", form.action, true);
    
        xhr.onload = function(e) {
            var response = JSON.parse(xhr.response);
            console.log(xhr.status);
    
            if (xhr.status >= 200 && xhr.status < 300) {
            UIkit.modal(document.getElementById('modal-contact-form')).hide();
            UIkit.notification({
                message: 'Успешно отправлено!',
                status: 'success',
                pos: 'bottom-right',
                timeout: 5000
            });
            } else {
            UIkit.notification({
                message: 'Ошибка!',
                status: 'danger',
                pos: 'bottom-right',
                timeout: 5000
            });
            }
        };
    
        xhr.send(formData);
        };
    </script>
    <script defer>
        document.addEventListener('readystatechange', () => console.log(document.readyState));
        function doFit(){
            console.log('doFit');
            textFit(document.querySelectorAll('.uk-overlay h4'));            
        }
        window.onload = doFit;
        window.onresize = doFit;
        //UIkit.util.on(document, 'DOMContentLoaded',doFit);
        document.addEventListener("DOMContentLoaded",doFit);
        if (document.readyState == 'complete') doFit();
    </script>   
</body>
</html>
